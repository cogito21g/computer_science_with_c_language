## 3. 어셈블리와 C 언어 인터페이스

### 3.1 어셈블리 언어 개요

**이론**

어셈블리 언어는 기계어와 1:1 대응되는 저수준 프로그래밍 언어로, 프로세서 명령어를 직접 다룹니다. 어셈블리 언어는 특정 하드웨어 아키텍처에 종속적이며, 프로그램이 하드웨어와 직접 상호작용할 수 있도록 합니다.

**어셈블리 언어의 특징**:
1. **하드웨어 제어**: 프로세서의 레지스터와 메모리를 직접 조작할 수 있습니다.
2. **고성능**: 최적화된 코드 작성이 가능하여 높은 성능을 발휘할 수 있습니다.
3. **기계어와의 대응**: 기계어와 1:1로 대응하여 기계어 명령어를 쉽게 이해할 수 있습니다.

**어셈블리 언어의 구성 요소**:
1. **명령어 (Instruction)**: 프로세서가 실행할 작업을 정의합니다. 예: `MOV`, `ADD`, `SUB`
2. **오퍼랜드 (Operand)**: 명령어가 작동하는 데이터입니다. 예: 레지스터, 메모리 주소, 상수
3. **레지스터 (Register)**: 프로세서 내부의 고속 저장 장치입니다. 예: `EAX`, `EBX`, `ECX`
4. **주석 (Comment)**: 코드의 설명을 위해 사용됩니다. 예: `; This is a comment`

### 어셈블리 언어의 기본 구조

어셈블리 언어 프로그램은 일반적으로 다음과 같은 기본 구조를 가집니다:
1. **섹션 (Section)**: 코드, 데이터, 스택 등으로 구분
2. **명령어 (Instruction)**: 프로세서가 수행할 작업
3. **레지스터와 메모리 참조**: 작업에 사용할 데이터의 위치

예제 코드를 통해 어셈블리 언어의 기본 구조를 이해해 보겠습니다.

### 예제

다음은 간단한 어셈블리 언어 프로그램으로, 두 수를 더하는 예제입니다.

```assembly
section .data
    num1 db 10         ; 첫 번째 숫자
    num2 db 20         ; 두 번째 숫자
    result db 0        ; 결과를 저장할 공간

section .text
    global _start      ; 프로그램의 시작점을 정의

_start:
    mov al, [num1]     ; num1의 값을 레지스터 AL에 로드
    add al, [num2]     ; num2의 값을 AL에 더함
    mov [result], al   ; 결과를 result에 저장

    ; 프로그램 종료
    mov eax, 60        ; 시스템 호출 번호 (sys_exit)
    xor edi, edi       ; 종료 상태 0
    syscall            ; 시스템 호출
```

### 코드 설명

- **section .data**: 데이터를 정의하는 섹션입니다. 여기에는 프로그램에서 사용할 변수들이 포함됩니다.
  - `num1 db 10`: num1 변수에 10을 저장합니다.
  - `num2 db 20`: num2 변수에 20을 저장합니다.
  - `result db 0`: 결과를 저장할 result 변수를 선언하고 0으로 초기화합니다.
- **section .text**: 코드를 정의하는 섹션입니다. 여기에는 실행할 명령어들이 포함됩니다.
  - `global _start`: 프로그램의 시작점을 정의합니다.
  - `_start`: 프로그램의 시작 라벨입니다.
    - `mov al, [num1]`: num1의 값을 AL 레지스터에 로드합니다.
    - `add al, [num2]`: num2의 값을 AL 레지스터에 더합니다.
    - `mov [result], al`: 결과를 result 변수에 저장합니다.
    - `mov eax, 60`: 시스템 호출 번호를 EAX 레지스터에 설정합니다 (sys_exit).
    - `xor edi, edi`: EDI 레지스터를 0으로 설정합니다 (종료 상태).
    - `syscall`: 시스템 호출을 실행합니다.

### 실습 과제

#### 과제 1: 두 수의 곱을 구하는 어셈블리 프로그램 작성

**목표**:
- 두 수를 곱한 결과를 계산하는 어셈블리 프로그램을 작성합니다.

**해설**:
- 두 개의 변수를 선언하고, 이 변수의 값을 곱하여 결과를 저장합니다.

```assembly
section .data
    num1 db 5          ; 첫 번째 숫자
    num2 db 4          ; 두 번째 숫자
    result db 0        ; 결과를 저장할 공간

section .text
    global _start      ; 프로그램의 시작점을 정의

_start:
    mov al, [num1]     ; num1의 값을 레지스터 AL에 로드
    mov bl, [num2]     ; num2의 값을 레지스터 BL에 로드
    mul bl             ; AL에 있는 값과 BL에 있는 값을 곱함
    mov [result], al   ; 결과를 result에 저장

    ; 프로그램 종료
    mov eax, 60        ; 시스템 호출 번호 (sys_exit)
    xor edi, edi       ; 종료 상태 0
    syscall            ; 시스템 호출
```
